import{j as e,r as l}from"./vendor-crfcZH_I.js";import{L as k,f as C,a as S}from"./index-t3xOy5g_.js";import{u as R,A as _,I as h}from"./Avatar-CB6fJAtS.js";function I(s){const t=["All","JavaScript","Ruby","Java","CSS","Python"];return e.jsx("div",{className:"flex items-center justify-center my-4",children:t.map(n=>{const c=n.toLowerCase()===s.language.toLowerCase();return e.jsx("button",{className:`mx-2 px-3 py-1 rounded-lg transition-all duration-300 ease-in-out transform ${c?"bg-green-500 text-white shadow-lg scale-105 hover:scale-110":"bg-green-100 text-green-700 hover:bg-green-200 hover:scale-105"}`,onClick:()=>s.change(n),children:n},n)})})}function E({loading:s,loadMore:t}){const n=l.useRef(null);return R({target:n,onIntersect:()=>{n.current&&s&&t()}}),e.jsx("div",{ref:n,className:`${s?"block":"hidden"}`,children:e.jsx(k,{})})}function M(s){const t=s.data;return e.jsx("div",{className:"flex-1 lg:w-[25%] lg:max-w-[25%] lg:min-w-[25%] md:w-[33.3%] md:max-w-[33.3%] md:min-w-[33.3%] w-[50%] max-w-[50%] min-w-[50%] p-2",children:e.jsxs("div",{className:"bg-green-100 py-4 rounded-lg hover:bg-green-200 transition-transform transform hover:scale-95",children:[e.jsxs("div",{className:"px-4 mb-2 text-center text-green-800 font-semibold",children:["第 ",s.indexKey," 名"]}),e.jsx("div",{className:"mb-4",children:e.jsx(_,{url:t.owner.avatar_url})}),e.jsxs("div",{className:"px-4",children:[e.jsx("div",{className:"mb-4 flex items-center justify-center",children:e.jsx("a",{href:t.html_url,target:"_blank",rel:"noopener noreferrer",className:"font-bold text-green-600 text-center text-sm truncate hover:text-green-800",title:t.name,children:t.name})}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(h,{iconName:"fa-user",className:" text-green-500"}),e.jsx("div",{className:"ml-2 flex-auto text-xs truncate text-green-700",children:t.owner.login})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(h,{iconName:"fa-star",className:" text-yellow-500"}),e.jsxs("div",{className:"ml-2 flex-auto text-xs truncate text-green-700",children:[e.jsx("span",{className:"font-bold mr-1",children:t.stargazers_count}),"stars"]})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(h,{iconName:"fa-code-fork",className:" text-green-500"}),e.jsxs("div",{className:"ml-2 flex-auto text-xs truncate text-green-700",children:[e.jsx("span",{className:"font-bold mr-1",children:t.forks_count}),"forks"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{iconName:"fa-triangle-exclamation",className:" text-blue-500"}),e.jsxs("div",{className:"ml-2 flex-auto text-xs truncate text-green-700",children:[e.jsx("span",{className:"font-bold mr-1",children:t.open_issues}),"open issues"]})]})]})]})},t.id)}function $({loading:s,items:t,loadMore:n,total:c,error:m}){return s&&t.length===0?e.jsx(k,{}):!s&&t.length===0?e.jsx("div",{className:"py-10 text-center text-slate-500 text-sm",children:"大皆空"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-wrap justify-around mx-2",children:t.map((i,o)=>e.jsx(M,{data:i,indexKey:o+1},`${i.id}-${o}`))}),e.jsx(E,{loading:t.length<c&&!m,loadMore:n})]})}function A({error:s,onReload:t}){const[n,c]=l.useState(!1);return l.useEffect(()=>{c(!!s)},[s]),e.jsx(e.Fragment,{children:n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-green-100 rounded-lg shadow-lg p-6 max-w-sm w-full",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-green-800",children:"接口异常"}),e.jsx("p",{className:"text-green-700",children:s}),e.jsxs("div",{className:"flex flex-1 gap-2 justify-end mt-6",children:[e.jsx("button",{onClick:()=>c(!1),className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300",children:"关闭"}),e.jsx("button",{onClick:()=>{c(!1),t(!0)},className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300",children:"重新加载"})]})]})})})}const F=()=>{const[s,t]=l.useState(0),[n,c]=l.useState(!0),[m,i]=l.useState([]),[o,N]=l.useState({current:1,lang:C(),limit:10}),v=l.useRef({}),[d,g]=l.useState(""),L=r=>{var f;g(""),N({lang:r,current:1,limit:10});const u=((f=v.current)==null?void 0:f[r])||[];u.length>0?i(u):(i([]),j(r,1,10)),window.history.replaceState({},"",`?language=${r}`)};l.useEffect(()=>{j(o.lang,o.current,o.limit)},[]);const j=(r,p,u)=>{c(!0),g("");const f=S(r,p,u);fetch(f).then(a=>a.ok?a.json():Promise.reject(a)).then(a=>{const x=(a==null?void 0:a.items)||[],y=p===1?x:[...m,...x];i(y),v.current[r]=y,t((a==null?void 0:a.total_count)||0)}).catch(a=>{a.json().then(x=>{g((x==null?void 0:x.message)||"Error")})}).finally(()=>c(!1))},w=()=>{N(r=>({...r,current:r.current+1})),j(o.lang,o.current+1,o.limit)},b=(r=!1)=>{if(r){w();return}n||d||w()};return e.jsxs(e.Fragment,{children:[e.jsx(I,{language:o.lang,change:L}),e.jsx(A,{error:d,onReload:b}),e.jsx($,{error:d,loading:n,items:m,total:s,loadMore:b}),!n&&d&&e.jsx("div",{className:"flex justify-center items-center pb-2",children:e.jsx("button",{className:`px-2 py-1  rounded transition-transform duration-300 transform bg-primary-dark text-white hover:bg-secondary-dark hover:scale-105 hover:shadow-outline-green
      }`,onClick:()=>{b(!0)},children:"⬇加载更多"})})]})},J=l.memo(F);export{J as default};
